<app-menu></app-menu>

<div class="container">
  <div class="row" style="padding: 5px">
    <div class="col s2">Логин</div>
    <div class="col s2">ФИО</div>
    <div class="col s2">Роль</div>
    <div class="col s2">Активна</div>
  </div>
  <div class="divider"></div>
  <div style="height: 70vh; overflow: auto">
    <ng-container *ngFor="let user of users; index as index">
      <div class="row" style="padding: 5px">
        <div class="col s2">
          <span>{{ user.login }}</span>
        </div>
        <div class="col s2">
          <span>{{ user.name }}</span>
        </div>
        <div class="col s2">
          <span>{{ user.role }}</span>
        </div>
        <div class="col s2">
          <div class="switch">
            <label>
              <input
                [checked]="user.activeState"
                type="checkbox"
                (click)="changeState(user.id, user.activeState, index)"
              />
              <span class="lever"></span>
            </label>
          </div>
        </div>
        <div class="col s3">
          <button
            (click)="getLogin(user.login)"
            class="btn btn-small modal-trigger blue lighten-1"
            data-target="changeUserPass"
          >
            Редактировать
          </button>
          <button
            (click)="deleteUser(user.id)"
            class="btn btn-small red lighten-1"
          >
            Удалить
          </button>
        </div>
      </div>
    </ng-container>
  </div>
  <div class="row">
    <button class="btn blue modal-trigger" data-target="add">
      Добавить пользователя
    </button>
  </div>
</div>
<div class="modal modal-fixed-footer" id="changePass">
  <div class="modal-content">
    <div class="card-content">
      <span class="card-title">Вход в личный кабинет</span>
      <div class="formGroup">
        <input id="pass" type="password" class="formControl" #pass required />
        <label for="pass">Введите новый пароль</label>
        <small class="helper-text invalid"></small>
        <small class="helper-text invalid"></small>
      </div>
      <div class="formGroup">
        <input
          id="ChangePassword"
          type="password"
          class="formControl"
          #newPass
          required
        />
        <label for="ChangePassword">Повторите новый пароль</label>
        <small class="helper-text invalid"></small>
        <small class="helper-text invalid"></small>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button
      [disabled]="pass.value !== newPass.value"
      (click)="changePassword(pass.value)"
      class="btn-flat green-text"
    >
      Сменить
      <i class="material-icons right">send</i>
    </button>
  </div>
</div>
<div class="modal modal-fixed-footer" id="add">
  <div class="modal-content">
    <form [formGroup]="form">
      <div class="row">
        <div class="col s6">
          <input formControlName="name" type="text" id="name" />
          <label for="name">Имя</label>
        </div>
        <div class="col s6">
          <input formControlName="login" type="text" id="login" />
          <label for="login">Логин</label>
        </div>
      </div>
      <div class="row">
        <div class="col s6">
          <input formControlName="password" type="text" id="password" />
          <label for="password">Пароль</label>
        </div>
        <div class="col s6">
          <p>
            <label>
              <input formControlName="role" type="radio" [value]="'admin'" />
              <span>Администратор</span>
            </label>
          </p>
          <p>
            <label>
              <input formControlName="role" type="radio" [value]="'super'" />
              <span>Оператор</span>
            </label>
          </p>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button class="btn-flat modal-close" (click)="addUser()">Добавить</button>
    <button class="btn-flat modal-close">Закрыть</button>
  </div>
</div>
<div class="modal" id="changeUserPass">
  <input type="text" #password />
  <button
    (click)="changeUserPassword(login, password.value)"
    class="btn-flat modal-close"
  >
    Изменить
  </button>
  <button class="btn-flat modal-close">Закрыть</button>
</div>
